function URLContent(e) { return UrlContent + e } function OnInitiativeTypeChanged(e, t) { var a = e.GetValue(); $.post(URLContent("ActiveInitiative/GetItemFromInitiativeType"), { id: a }, function (e) { var t; CostCategoryID.ClearItems(), $.each(e[0].CostTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && CostCategoryID.AddItem(t.CostTypeName, t.id) }), CostCategoryID.SelectIndex(0) }) } function OnCostCategoryChanged(e, t) { var a = InitiativeType.GetValue(InitiativeType.GetSelectedIndex()), l = e.GetValue(), n = BrandID.GetValue(BrandID.GetSelectedIndex()); $.post(URLContent("ActiveInitiative/GetItemFromCostCategory"), { id: a, id2: l, id3: n }, function (e) { var t; SubCostCategoryID.ClearItems(), ActionTypeID.ClearItems(), $.each(e[0].SubCostData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && SubCostCategoryID.AddItem(t.SubCostName, t.id) }), $.each(e[0].ActionTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ActionTypeID.AddItem(t.ActionTypeName, t.id) }), SubCostCategoryID.SelectIndex(0), ActionTypeID.SelectIndex(0) }) } function OnSubCountryChanged(e, t) { var a = e.GetValue(); $.post(URLContent("ActiveInitiative/GetCountryBySub"), { id: a }, function (e) { var t; CountryID.ClearItems(), BrandID.ClearItems(), RegionID.ClearItems(), SubRegionID.ClearItems(), ClusterID.ClearItems(), RegionalOfficeID.ClearItems(), CostControlID.ClearItems(), LegalEntityID.ClearItems(), InitiativeType.ClearItems(), $.each(e[0].CountryData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && CountryID.AddItem(t.CountryName, t.id) }), $.each(e[0].BrandData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && BrandID.AddItem(t.BrandName, t.id) }), $.each(e[0].LegalEntityData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && LegalEntityID.AddItem(t.LegalEntityName, t.id) }), $.each(e[0].RegionData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && RegionID.AddItem(t.RegionName, t.id) }), $.each(e[0].SubRegionData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && SubRegionID.AddItem(t.SubRegionName, t.id) }), $.each(e[0].ClusterData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ClusterID.AddItem(t.ClusterName, t.id) }), $.each(e[0].RegionalOfficeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && RegionalOfficeID.AddItem(t.RegionalOfficeName, t.id) }), $.each(e[0].CostControlSiteData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && CostControlID.AddItem(t.CostControlSiteName, t.id) }), $.each(e[0].TypeInitiativeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && InitiativeType.AddItem(t.SavingTypeName, t.id) }), CountryID.SelectIndex(0), BrandID.SelectIndex(0), RegionID.SelectIndex(0), SubRegionID.SelectIndex(0), ClusterID.SelectIndex(0), RegionalOfficeID.SelectIndex(0), CostControlID.SelectIndex(0), LegalEntityID.SelectIndex(0), InitiativeType.SelectIndex(0) }) } function OnBrandChanged(e, t) { var a = e.GetValue(), l = CountryID.GetValue(); $.post(URLContent("ActiveInitiative/GetLegalFromBrand"), { brandid: a, countryid: l }, function (e) { var t; LegalEntityID.ClearItems(), $.each(e[0].LegalEntityData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && LegalEntityID.AddItem(t.LegalEntityName, t.id) }), LegalEntityID.SelectIndex(0) }) } function onContextMenuItemFormGridViewClick(e, t) { var a = t.elementIndex, l = e.GetRowKey(a); switch (t.item.name) { case "Info": alert("Edit Detail => s.GetRowKey(key) = " + l + " || e.elementIndex = " + a); break; case "EditDetail": ShowEditWindow(l) } } function onRowDoubleClick(e, t) { var a = t.visibleIndex; ShowEditWindow(e.GetRowKey(a)) } function PretDut() { GrdSubCountryPopup.GetGridView().GetItemValues(0, "SubCountryName", OnGetRowValues) } function OnGetRowValues2(e) { } function OnGetRowValues(e) { GrdSubCountryPopup.SetText = e } function ShowEditWindow(e) { var t = 0, a = 0, l = projectYear; t = +l - 1, a = +l, StartMonth.SetMinDate(new Date(t + "-01-01")), StartMonth.SetMaxDate(new Date(a + "-12-31")), EndMonth.SetMinDate(new Date(a + "-01-01")), EndMonth.SetMaxDate(new Date(a + 1 + "-12-31")), $("#FormStatus").val("Edit"); var n = 0, r = 0, i = 0, o = 0, u = 0, g = 0, d = 0, s = 0; CboHoValidity.AddItem("Y"), CboHoValidity.AddItem("N"), CboRPOCValidity.AddItem("KO", "KO"), CboRPOCValidity.AddItem("Under Review", "UR"), CboRPOCValidity.AddItem("OK Level 1 - L1 if FY Target > 200 kUSD (L1= Cost controller)", "L1"), CboRPOCValidity.AddItem("OK Level 2 - L2 if FY Target > 300 kUSD (L2 =Management RO)", "L2"), CboRPOCValidity.AddItem("OK Level 3 - L3 if FY Target > 500 kUSD (L3 = Coordinateur HO)", "L3"), $.post(URLContent("ActiveInitiative/GetInfoById"), { Id: e }, function (t) { if ("" != t) { var a, l, c = JSON.parse(t), v = c.SubCountryID; n = c.InitiativeType, r = c.ActionTypeID, i = c.SynergyImpactID, o = c.InitStatus, u = c.PortID, g = c.CostCategoryID, d = c.SourceCategory, s = c.SubCostCategoryID, $.post(URLContent("ActiveInitiative/GetInfoForPopUp"), { Id: e }, function (e) { var t; GrdInitType.ClearItems(), GrdActionType.ClearItems(), GrdSynImpact.ClearItems(), GrdInitStatus.ClearItems(), TxPortName.ClearItems(), GrdInitCategory.ClearItems(), GrdSubCost.ClearItems(), user_type, CboWebinarCat.ClearItems(), $.each(e[0].SavingTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitType.AddItem(t.SavingTypeName, t.id) }), $.each(e[0].ActionTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdActionType.AddItem(t.ActionTypeName, t.id), console.log(t.id) }), $.each(e[0].SynImpactData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdSynImpact.AddItem(t.SynImpactName, t.id) }), $.each(e[0].InitStatusData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitStatus.AddItem(t.Status, t.id) }), $.each(e[0].PortNameData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && TxPortName.AddItem(t.PortName, t.id) }), $.each(e[0].MCostTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitCategory.AddItem(t.CostTypeName, t.id) }), $.each(e[0].MSubCostData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdSubCost.AddItem(t.SubCostName, t.id) }), $.each(e[0].MSourceCategory, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && CboWebinarCat.AddItem(t.categoryname, t.id) }), null != n ? GrdInitType.SelectIndex(n) : GrdInitType.SelectIndex(0), null != r ? GrdActionType.SelectIndex(r) : GrdActionType.SelectIndex(0), null != i ? GrdSynImpact.SelectIndex(i) : GrdSynImpact.SelectIndex(0), null != o ? GrdInitStatus.SelectIndex(o) : GrdInitStatus.SelectIndex(0), null != u ? TxPortName.SelectIndex(u) : TxPortName.SelectIndex(0), null != g ? GrdInitCategory.SelectIndex(g) : GrdInitCategory.SelectIndex(0), null != d ? CboWebinarCat.SelectIndex(d) : CboWebinarCat.SelectIndex(0), null != s ? GrdSubCost.SelectIndex(s) : GrdSubCost.SelectIndex(0), TxPortName.SetValue(c.PortID), GrdInitType.SetValue(c.InitiativeType), GrdActionType.SetValue(c.ActionTypeID), GrdSynImpact.SetValue(c.SynergyImpactID), GrdInitStatus.SetValue(c.InitStatus), GrdInitCategory.SetValue(c.CostCategoryID), CboWebinarCat.SetValue(c.SourceCategory), GrdSubCost.SetValue(c.SubCostCategoryID) }); var m = user_type; $("#FormID").val(c.id), $("#LblInitiative").text(c.InitNumber), LblRelatedInitiative.SetValue(c.RelatedInitiative), $("#GrdCountry").val(c.CountryName), $("#GrdCountryVal").val(c.CountryID), $("#GrdRegional").val(c.RegionName), $("#GrdRegionalVal").val(c.RegionID), $("#GrdSubRegion").val(c.SubRegionName), $("#GrdSubRegionVal").val(c.SubRegionID), $("#GrdCluster").val(c.ClusterName), $("#GrdClusterVal").val(c.ClusterID), $("#GrdRegionalOffice").val(c.RegionalOffice_Name), $("#GrdRegionalOfficeVal").val(c.RegionalOfficeID), CboConfidential.SetValue(c.Confidential), StartMonth.SetValue(new Date(c.StartMonth)), EndMonth.SetValue(new Date(c.EndMonth)), CboWebinarCat.SetValue(c.SourceCategory), $("#GrdCostControl").val(c.CostControlSiteName), $("#GrdCostControlVal").val(c.CostControlID), $("#GrdInitCategory").val(c.CostTypeName), $("#GrdActionType").val(c.ActionTypeName), $("#GrdSynImpact").val(c.SynImpactName), $("#TxResponsibleName").val(c.ResponsibleFullName), $("#TxLaraCode").val(c.LaraCode), $("#TxDesc").val(c.Description), $("#GrdBrandPopup").val(c.brandname), $("#GrdLegalEntityPopup").val(c.LegalEntityName), GrdInitStatus.SetValue(c.InitStatus), TxPortName.SetValue(c.PortID), GrdInitType.SetValue(c.InitiativeType), GrdInitCategory.SetValue(c.CostCategoryID), GrdSubCost.SetValue(c.SubCostCategoryID), GrdActionType.SetValue(c.ActionTypeID), GrdSynImpact.SetValue(c.SynergyImpactID), $("#TxVendorSupp").val(c.VendorName), $("#TxAdditionalInfo").val(c.AdditionalInfo), $("#TxAgency").val(c.AgencyComment), $("#TxRPOCComment").val(c.RPOCComment), $("#TxHOComment").val(c.HOComment), CboHoValidity.SetValue(c.HOValidity), CboRPOCValidity.SetValue(c.RPOCControl), txTarget12.SetValue(c.TargetTY), txTargetFullYear.SetValue(c.TargetNY), txYTDTargetFullYear.SetValue(c.YTDTarget), txYTDSavingFullYear.SetValue(c.YTDAchieved), GrdBrandPopup.SetValue(c.BrandID), GrdLegalEntityPopup.SetValue(c.LegalEntityID), OnStartMonthChanged(); let p = new Date(c.StartMonth).getFullYear(), f = p + 1; $("#ljan").html("Jan-" + p), $("#lfeb").html("Feb-" + p), $("#lmar").html("Mar-" + p), $("#lapr").html("Apr-" + p), $("#lmay").html("May-" + p), $("#ljun").html("Jun-" + p), $("#ljul").html("Jul-" + p), $("#laug").html("Aug-" + p), $("#lsep").html("Sep-" + p), $("#loct").html("Oct-" + p), $("#lnov").html("Nov-" + p), $("#ldec").html("Dec-" + p), $("#lnexjan").html("Jan-" + f), $("#lnexfeb").html("Feb-" + f), $("#lnexmar").html("Mar-" + f), $("#lnexapr").html("Apr-" + f), $("#lnexmay").html("May-" + f), $("#lnexjun").html("Jun-" + f), $("#lnexjul").html("Jul-" + f), $("#lnexaug").html("Aug-" + f), $("#lnexsep").html("Sep-" + f), $("#lnexoct").html("Oct-" + f), $("#lnexnov").html("Nov-" + f), $("#lnexdec").html("Dec-" + f), $(".targetjan").val(formatValue(c.TargetJan)), $(".targetfeb").val(formatValue(c.TargetFeb)), $(".targetmar").val(formatValue(c.TargetMar)), $(".targetapr").val(formatValue(c.TargetApr)), $(".targetmay").val(formatValue(c.TargetMay)), $(".targetjun").val(formatValue(c.TargetJun)), $(".targetjul").val(formatValue(c.TargetJul)), $(".targetaug").val(formatValue(c.TargetAug)), $(".targetsep").val(formatValue(c.TargetSep)), $(".targetoct").val(formatValue(c.TargetOct)), $(".targetnov").val(formatValue(c.TargetNov)), $(".targetdec").val(formatValue(c.TargetDec)), $(".savingjan").val(formatValue(c.AchJan)), $(".savingfeb").val(formatValue(c.AchFeb)), $(".savingmar").val(formatValue(c.AchMar)), $(".savingapr").val(formatValue(c.AchApr)), $(".savingmay").val(formatValue(c.AchMay)), $(".savingjun").val(formatValue(c.AchJun)), $(".savingjul").val(formatValue(c.AchJul)), $(".savingaug").val(formatValue(c.AchAug)), $(".savingsep").val(formatValue(c.AchSep)), $(".savingoct").val(formatValue(c.AchOct)), $(".savingnov").val(formatValue(c.AchNov)), $(".savingdec").val(formatValue(c.AchDec)), $(".targetjan2").val(formatValue(c.TargetNexJan)), $(".targetfeb2").val(formatValue(c.TargetNexFeb)), $(".targetmar2").val(formatValue(c.TargetNexMar)), $(".targetapr2").val(formatValue(c.TargetNexApr)), $(".targetmay2").val(formatValue(c.TargetNexMay)), $(".targetjun2").val(formatValue(c.TargetNexJun)), $(".targetjul2").val(formatValue(c.TargetNexJul)), $(".targetaug2").val(formatValue(c.TargetNexAug)), $(".targetsep2").val(formatValue(c.TargetNexSep)), $(".targetoct2").val(formatValue(c.TargetNexOct)), $(".targetnov2").val(formatValue(c.TargetNexNov)), $(".targetdec2").val(formatValue(c.TargetNexDec)), $(".savingjan2").val(formatValue(c.AchNexJan)), $(".savingfeb2").val(formatValue(c.AchNexFeb)), $(".savingmar2").val(formatValue(c.AchNexMar)), $(".savingapr2").val(formatValue(c.AchNexApr)), $(".savingmay2").val(formatValue(c.AchNexMay)), $(".savingjun2").val(formatValue(c.AchNexJun)), $(".savingjul2").val(formatValue(c.AchNexJul)), $(".savingaug2").val(formatValue(c.AchNexAug)), $(".savingsep2").val(formatValue(c.AchNexSep)), $(".savingoct2").val(formatValue(c.AchNexOct)), $(".savingnov2").val(formatValue(c.AchNexNov)), $(".savingdec2").val(formatValue(c.AchNexDec)), 4 == c.InitStatus ? $(".txSaving").prop("disabled", !0) : 1 == c.InitStatus && 3 == m ? $("#btnSave").prop("disabled", !0) : 2 == c.InitStatus && 3 == m && $("#btnSave").prop("disabled", !0); var C = c.LegalEntityID, I = c.BrandID; $.post(URLContent("ActiveInitiative/GetCountryBySub"), { Id: v, Id2: e }, function (e) { var t; GrdSubCountryPopup.ClearItems(), GrdBrandPopup.ClearItems(), GrdLegalEntityPopup.ClearItems(), $.each(e[0].SubCountryData, function (e, a) { t = JSON.parse(a = JSON.stringify(a)), null != c && GrdSubCountryPopup.AddItem(t.SubCountryName, t.id) }), $.each(e[0].BrandData, function (e, a) { t = JSON.parse(a = JSON.stringify(a)), null != c && GrdBrandPopup.AddItem(t.BrandName, t.id) }), $.each(e[0].LegalEntityData, function (e, a) { t = JSON.parse(a = JSON.stringify(a)), null != c && GrdLegalEntityPopup.AddItem(t.LegalEntityName, t.id) }), GrdSubCountryPopup.SelectIndex(0), GrdBrandPopup.SelectIndex(0), GrdLegalEntityPopup.SelectIndex(0), GrdBrandPopup.SetValue(I), GrdLegalEntityPopup.SetValue(C) }), getYtdValue(), hitungtahunini(); var S = projectYear; years_right.includes(S) ? $("#btnSave").prop("disabled", "") : $("#btnSave").prop("disabled", "disabled"), $("#TxAgency, #TxRPOCComment, #TxHOComment").prop("disabled", !0), 1 == m && $("#TxHOComment").prop("disabled", !1), 2 == m && $("#TxRPOCComment").prop("disabled", !1), 3 == m && $("#TxAgency").prop("disabled", !1), OnEndMonthChanged(), a = $("#FormStatus").val(), l = GrdInitStatus.GetValue(), 3 == m && "Edit" == a && "4" != l && ($("#chkAuto").prop("disabled", !0), $(".txTarget").prop("disabled", !0), StartMonth.clientEnabled = !1, EndMonth.clientEnabled = !1, txTarget12.clientEnabled = !1), WindowInitiative.Show() } }) } function DeleteReport(e) { WarningDeleteReport("Detail Info For This ARO Counting Number " + e, e) } function WarningDeleteReport(e, t) { return Swal.fire({ title: "Detail Info", text: e, type: "info", cancelButtonColor: "btn btn-success" }).then(e => { e.value && doDeleteReport(t) }), !1 } function doDeleteReport(e) { $.ajax({ type: "POST", url: urlDeleteReport, data: { id: e }, beforeSend: function () { ___lp.Show() }, error: function (e, t, a) { if (___lp.Hide(), e.responseText) "__sessiontimeout" == e.responseText && (window.location = _urlLogOff); else { var l = "Sorry, There is a problem. "; t.length > 0 && (l += "(" + t + ")."), FailMsg(l) } }, success: function (e) { ___lp.Hide(), "success" == e.status ? (cmrMainGridView.PerformCallback(), SuccessMsg("Report successfully deleted.")) : "fail" == e.status ? (isThereNewRecord = !1, FailMsg(e.error_message)) : "__sessiontimeout" == e ? window.location = urlLogOffOrg : FailMsg(e.error_message) } }) } function OnCloseNewInitiativeWindow() { $("#LblInitiative").text(SystemYearNow + "XX####"), GrdSubCountryPopup.SetValue(null), GrdBrandPopup.SetValue(null), GrdBrandPopup.ClearItems(), GrdLegalEntityPopup.SetValue(null), GrdLegalEntityPopup.ClearItems(), CboConfidential.SetValue(null), $(".inputan-popup").val(null), $("#GrdCountry").val(null), $("#GrdRegional").val(null), $("#GrdSubRegion").val(null), $("#GrdCluster").val(null), $("#GrdRegionalOffice").val(null), GrdInitStatus.SetValue(null), $("#GrdCostControl").val(null), $("#GrdInitCategory").val(null), GrdInitCategory.ClearItems(), $("#GrdSubCost").val(null), $("#GrdActionType").val(null), $("#GrdSynImpact").val(null), $("#TxResponsibleName").val(null), $("#TxLaraCode").val(null), $("#TxDesc").val(null), $("#TxPortName").val(null), $("#TxVendorSupp").val(null), $("#TxAdditionalInfo").val(null), $("#TxAgency").val(null), $("#TxRPOCComment").val(null), $("#TxHOComment").val(null), $("#chkAuto").prop("checked", !1), $(".txTarget").prop("disabled", !1), $(".txSaving, .txTarget").val(""), $(".txSaving,#btnDuplicate,#btnSave,#TxResponsibleName,#TxDesc,#TxLaraCode,#TxPortName,#TxVendorSupp,#TxAdditionalInfo,#TxAgency,#TxRPOCComment,#TxHOComment").prop("disabled", !1), GrdInitType.SetValue(null), GrdInitStatus.ClearItems(), TxPortName.ClearItems(), GrdInitType.ClearItems(), GrdActionType.ClearItems(), CboHoValidity.ClearItems(), CboRPOCValidity.ClearItems(), CboRPOCValidity.ClearItems(), GrdSubCost.ClearItems(), txTarget12.SetValue(), txTargetFullYear.SetValue(), txYTDTargetFullYear.SetValue(), txYTDSavingFullYear.SetValue(), GrdActionType.SetValue(null), StartMonth.SetValue(null), EndMonth.SetValue(null), LblRelatedInitiative.SetValue(null), CboWebinarCat.ClearItems(), $("#chkAuto").prop("disabled", !1), $(".txTarget").prop("disabled", !1), $("input[name='StartMonth']").prop("disabled", !1), $("input[name='StartMonth']").prop("readonly", !1), StartMonth.clientEnabled = !0, EndMonth.clientEnabled = !0, txTarget12.clientEnabled = !0, $.post(URLContent("ActiveInitiative/RemoveSelectedGridLookup"), function (e) { console.log(e) }) } function OnInit(e, t) { GrdSubCountryPopup.SelectIndex(0), AdjustSize() } function OnEndCallback(e, t) { AdjustSize(), UpdateFigureWidget(e) } function UpdateFigureWidget(e) { $("#sp-num-of-init").html(e.cpNumberOfInitiative), $("#sp-total-target").html(e.cpTotalTarget), $("#sp-total-saving-achieved").html(e.cpTotalSavingAchieved) } function AdjustSize() { var e = window.innerHeight - 250; GrdMainInitiative.SetHeight(e) } function BtnExportXls() { GrdMainInitiative.ExportTo("Xls") } function BtnExportPdf() { GrdMainInitiative.ExportTo("Pdf") } function OnSubCountryPopupChanged(e, t) { var a = e.GetValue(); $("#GrdCountryVal").val(""), $("#GrdCountry").val(""), $("#GrdRegionalVal").val(""), $("#GrdRegional").val(""), $("#GrdSubRegionVal").val(""), $("#GrdSubRegion").val(""), $("#GrdClusterVal").val(""), $("#GrdCluster").val(""), $("#GrdRegionalOfficeVal").val(""), $("#GrdRegionalOffice").val(""), $("#GrdCostControlVal").val(""), $("#GrdCostControl").val(""), $.post(URLContent("ActiveInitiative/GetCountryBySub"), { id: a }, function (e) { var t; GrdBrandPopup.ClearItems(), GrdLegalEntityPopup.ClearItems(), GrdBrandPopup.AddItem("[ Please Select ]", 0), $.each(e[0].BrandData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdBrandPopup.AddItem(t.BrandName, t.id) }), GrdLegalEntityPopup.AddItem("[ Please Select ]", 0), $.each(e[0].LegalEntityData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdLegalEntityPopup.AddItem(t.LegalEntityName, t.id) }), $.each(e[0].CountryData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdCountryVal").val(t.id), $("#GrdCountry").val(t.CountryName)) }), $.each(e[0].RegionData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdRegionalVal").val(t.id), $("#GrdRegional").val(t.RegionName)) }), $.each(e[0].SubRegionData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdSubRegionVal").val(t.id), $("#GrdSubRegion").val(t.SubRegionName)) }), $.each(e[0].ClusterData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdClusterVal").val(t.id), $("#GrdCluster").val(t.ClusterName)) }), $.each(e[0].RegionalOfficeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdRegionalOfficeVal").val(t.id), $("#GrdRegionalOffice").val(t.RegionalOfficeName)) }), $.each(e[0].CostControlSiteData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdCostControlVal").val(t.id), $("#GrdCostControl").val(t.CostControlSiteName)) }), GrdBrandPopup.SelectIndex(0) }) } function OnBrandPopupChanged(e, t) { var a = e.GetValue(), l = $("#GrdCountryVal").val(), n = GrdSubCountryPopup.GetValue(), r = $("#GrdCostControlVal").val(); $.post(URLContent("ActiveInitiative/GetLegalFromBrand"), { BrandID: a, CountryID: l, SubCountryID: n, CostControlSiteID: r }, function (e) { var t; GrdLegalEntityPopup.ClearItems(), $.each(e[0].LegalEntityData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdLegalEntityPopup.AddItem(t.LegalEntityName, t.id) }), $.each(e[0].CostControlSiteData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && ($("#GrdCostControlVal").val(t.id), $("#GrdCostControl").val(t.CostControlSiteName)) }), GrdLegalEntityPopup.SelectIndex(0) }) } function OnGrdInitTypeChanged(e, t) { var a = e.GetValue(); $.post(URLContent("ActiveInitiative/GetItemFromInitiativeType"), { id: a }, function (e) { var t; GrdInitCategory.ClearItems(), $.each(e[0].CostTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitCategory.AddItem(t.CostTypeName, t.id) }), GrdInitCategory.SelectIndex(0) }) } function OnSubCostPopupChanged(e, t) { var a = e.GetValue(); $.post(URLContent("ActiveInitiative/GetItemFromSubCost"), { id: a }, function (e) { var t; GrdActionType.ClearItems(), $.each(e[0].ActionTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdActionType.AddItem(t.ActionTypeName, t.id) }), GrdActionType.SelectIndex(0) }) } function OnGrdInitCategoryPopupChanged(e, t) { var a = GrdInitType.GetValue(), l = e.GetValue(), n = GrdBrandPopup.GetValue(); $.post(URLContent("ActiveInitiative/GetItemFromCostCategory"), { id: a, id2: l, id3: n }, function (e) { var t; GrdSubCost.ClearItems(), $.each(e[0].SubCostData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdSubCost.AddItem(t.SubCostName, t.id) }), GrdSubCost.SelectIndex(0) }) } function OnCboYearChanged(e, t) { var a = e.GetText(); $.post(URLContent("ActiveInitiative/ProjectYear"), { Id: a }, function () { window.location.reload() }) } function OnClickEventReview(e, t) { var a = e.GetRowKey(t.visibleIndex); $(".titleinitiative").html(""), $.post(URLContent("EventReview/SetEventReviewID"), { ID: a }, function (e) { $(".titleinitiative").html("Initiative Number: " + e), GrdEventReview.Refresh(), WindowEventReview.Show() }) } function OnClickComment(e, t) { var a = e.GetRowKey(t.visibleIndex); $.post(URLContent("ActiveInitiative/GetInitiativeComment"), { Id: a }, function (e) { var t = e.AgencyComment, a = e.RPOCComment, l = e.HOComment; (null == t || "" == t) && (t = "Not Commented Yet"), (null == a || "" == a) && (a = "Not Commented Yet"), (null == l || "" == l) && (l = "Not Commented Yet"), $(".agencyexcerpt").html(t), $(".rpocexcerpt").html(a), $(".hoexcerpt").html(l), WindowComment.Show() }) } function OnClickUpload(e, t) { var a = e.GetRowKey(t.visibleIndex); $.post(URLContent("ActiveInitiative/SetIDUploadFile"), { ID: a }, function (e) { var t, a = e[0].InitiativeNumber; $(".UploadInitiativeNumber").html(a), $.each(e[0].UploadedFileData, function (e, l) { if (null != (t = JSON.parse(l = JSON.stringify(l))).UploadedFileName) { var n = "", r = t.UploadedFileName.split("|"); if ("" != r[0]) { for (var i = 0; i < r.length; i++)"" != r[i] && (n += '<tr><td width="660"><a href="' + UploadDirectory + r[i] + '" target="_new" >' + r[i] + '</td><td><button type="button" class="btn btn-danger btn-xs" onClick="removefile(\'' + a + "','" + r[i] + "',this)\" >Remove</button></td></tr>"), i++; $("#summary-uploaded-files").html(n) } else $("#summary-uploaded-files").html('<tr><td colspan="2"><center>There is no File Uploaded</center></td></tr>') } else $("#summary-uploaded-files").html('<tr><td colspan="2"><center>There is no File Uploaded</center></td></tr>') }), WindowUpload.Show() }) } function onUploadControlFileUploadComplete(e, t) { if (t.callbackData) { var a = $("#summary-uploaded-files").html(), l = t.callbackData.split("|"), n = l[0], r = l[1], i = "label-warning"; "success" == status ? i = "label-success" : "fail" == status && (i = "label-danger"), '<tr><td colspan="2"><center>There is no File Uploaded</center></td></tr>' == a && $("#summary-uploaded-files").html(""), "" != n && $("#summary-uploaded-files").append("<tr><td width='660'><a href=\"" + UploadDirectory + n + '" target="_new">' + n + '</a></td><td><button type="button" class="btn btn-danger btn-xs" onClick="removefile(\'' + r + "','" + n + "',this)\" >Remove</button></td></tr>"), GrdMainInitiative.Refresh() } } function removefile(e, t, a) { Swal.fire({ title: "Confirmation", text: "Are you sure to remove this file ?", icon: "warning", showCancelButton: !0, confirmButtonText: "Remove" }).then(l => { l.value && $.post(URLContent("ActiveInitiative/removefile"), { Initiativenumber: e, Filename: t }, function (e) { console.log(e), $(a).closest("tr").remove(), "" == $("#summary-uploaded-files").html() && $("#summary-uploaded-files").html('<tr><td colspan="2"><center>There is no File Uploaded</center></td></tr>'), GrdMainInitiative.Refresh() }) }) } function OnStartMonthChanged() { OnEndMonthChanged(); var e = StartMonth.GetValue(), t = new Date(e.getFullYear(), e.getMonth() + 11, 1); EndMonth.SetMaxDate(t) } function OnEndMonthChanged() { var e, t, a, l, n, r = !1, i = ""; i = null == EndMonth.GetValue() ? StartMonth.GetValue() : EndMonth.GetValue(); var o = [], u = []; o = ["targetjan", "targetfeb", "targetmar", "targetapr", "targetmay", "targetjun", "targetjul", "targetaug", "targetsep", "targetoct", "targetnov", "targetdec", "targetjan2", "targetfeb2", "targetmar2", "targetapr2", "targetmay2", "targetjun2", "targetjul2", "targetaug2", "targetsep2", "targetoct2", "targetnov2", "targetdec2"], u = ["savingjan", "savingfeb", "savingmar", "savingapr", "savingmay", "savingjun", "savingjul", "savingaug", "savingsep", "savingoct", "savingnov", "savingdec", "savingjan2", "savingfeb2", "savingmar2", "savingapr2", "savingmay2", "savingjun2", "savingjul2", "savingaug2", "savingsep2", "savingoct2", "savingnov2", "savingdec2"], e = moment(StartMonth.GetValue()).format("M") - 1; var g = 0; t = (i.getFullYear() - StartMonth.GetValue().getFullYear()) * 12, t -= StartMonth.GetValue().getMonth(), t += i.getMonth(), t++; for (var d = 0; d <= o.length; d++)!0 == (r = !!(d >= e) && !!(g < t)) ? ($("." + o[d]).prop("disabled", !1), $("." + u[d]).prop("disabled", !1), g++) : ($("." + o[d]).val(""), $("." + u[d]).val(""), $("." + o[d]).prop("disabled", !0), $("." + u[d]).prop("disabled", !0)); if (projectYear != StartMonth.GetValue().getFullYear()) for (var d = 0; d < 12; d++)$("." + o[d]).prop("disabled", !0), $("." + u[d]).prop("disabled", !0); n = user_type, a = $("#FormStatus").val(), l = GrdInitStatus.GetValue(), 3 == n && "Edit" == a && "4" != l && ($("#chkAuto").prop("disabled", !0), $(".txTarget").prop("disabled", !0)) } function OnInitStatusChanged(e, t) { var a = e.GetText(), l = user_type, n = $("#FormStatus").val(); 3 == l && "Pending" == a && "New" != n && (GrdInitStatus.SelectIndex(0), Swal.fire("You can not change the status", "Agency user can not change to pending", "error")) } function isNumberKey(e) { var t = e.which ? e.which : e.keyCode; return 45 == t || 46 == t || !(t > 31) || !(t < 48) && !(t > 57) || (Swal.fire("Numeric only", "You can not input alphanumeric character here", "error"), !1) } function OnClickEditInitiative(e, t) { ShowEditWindow(e.GetRowKey(t.visibleIndex)) } function formatValue(e) { return 0 === e ? 0 : null == e || "" == e ? "" : parseFloat(e = String(e).replaceAll(",", "")).toFixed(2).replaceAll(/\d(?=(\d{3})+\.)/g, "$&,") } function calculateSum() { var e, t = 0; return $(".txTarget").each(function () { 1 > (e = this.name).indexOf("2") && 0 != this.value.length && (t += parseFloat(this.value.replaceAll(",", ""))) }), t.toFixed(2) } function calculateAllTarget() { var e, t = 0; return $(".txTarget").each(function () { e = this.name, 0 != this.value.length && (t += parseFloat(this.value.replaceAll(",", ""))) }), t.toFixed(2) } function SaveInitiative() { Swal.fire({ title: "Do you want to save the changes?", icon: "warning", showCancelButton: !0, confirmButtonText: "Save" }).then(e => { if (e.isConfirmed) { var t = $("#FormStatus").val(), a = $("#FormID").val(), l = GrdSubCountryPopup.GetValue(), n = GrdBrandPopup.GetValue(), r = GrdLegalEntityPopup.GetValue(), i = $("#GrdCountryVal").val(), o = $("#GrdRegionalVal").val(), u = $("#GrdSubRegionVal").val(), g = $("#GrdClusterVal").val(), d = $("#GrdRegionalOfficeVal").val(), s = $("#GrdCostControlVal").val(), c = CboConfidential.GetValue(), v = $("#TxResponsibleName").val(), m = $("#TxDesc").val(), p = GrdInitStatus.GetValue(), f = $("#TxLaraCode").val(), C = 0 == TxPortName.GetValue() ? 1 : TxPortName.GetValue(), I = $("#TxVendorSupp").val(), S = $("#TxAdditionalInfo").val(), h = GrdInitType.GetValue(), y = GrdInitCategory.GetValue(), V = GrdSubCost.GetValue(), A = GrdActionType.GetValue(), x = GrdSynImpact.GetValue(), b = StartMonth.GetValue(); null != b && (b = b.format("Y-m-d")); var G = EndMonth.GetValue(); null != G && (G = G.format("Y-m-d")); var T = $("#TxAgency").val(), D = $("#TxRPOCComment").val(), N = $("#TxHOComment").val(), R = CboHoValidity.GetValue(), j = CboRPOCValidity.GetValue(), _ = txTarget12.GetValue(), O = txTargetFullYear.GetValue(), F = txYTDTargetFullYear.GetValue(), w = txYTDSavingFullYear.GetValue(), L = CboYear.GetText(), M = LblRelatedInitiative.GetValue(), U = CboWebinarCat.GetValue(), E = $(".targetjan").val().replaceAll(",", ""), Y = $(".targetfeb").val().replaceAll(",", ""), k = $(".targetmar").val().replaceAll(",", ""), P = $(".targetapr").val().replaceAll(",", ""), B = $(".targetmay").val().replaceAll(",", ""), J = $(".targetjun").val().replaceAll(",", ""), H = $(".targetjul").val().replaceAll(",", ""), K = $(".targetaug").val().replaceAll(",", ""), W = $(".targetsep").val().replaceAll(",", ""), X = $(".targetoct").val().replaceAll(",", ""), z = $(".targetnov").val().replaceAll(",", ""), q = $(".targetdec").val().replaceAll(",", ""), Q = $(".targetjan2").val().replaceAll(",", ""), Z = $(".targetfeb2").val().replaceAll(",", ""), ee = $(".targetmar2").val().replaceAll(",", ""), et = $(".targetapr2").val().replaceAll(",", ""), ea = $(".targetmay2").val().replaceAll(",", ""), el = $(".targetjun2").val().replaceAll(",", ""), en = $(".targetjul2").val().replaceAll(",", ""), er = $(".targetaug2").val().replaceAll(",", ""), ei = $(".targetsep2").val().replaceAll(",", ""), eo = $(".targetoct2").val().replaceAll(",", ""), eu = $(".targetnov2").val().replaceAll(",", ""), eg = $(".targetdec2").val().replaceAll(",", ""), ed = $(".savingjan").val().replaceAll(",", ""), es = $(".savingfeb").val().replaceAll(",", ""), ec = $(".savingmar").val().replaceAll(",", ""), ev = $(".savingapr").val().replaceAll(",", ""), em = $(".savingmay").val().replaceAll(",", ""), ep = $(".savingjun").val().replaceAll(",", ""), ef = $(".savingjul").val().replaceAll(",", ""), eC = $(".savingaug").val().replaceAll(",", ""), eI = $(".savingsep").val().replaceAll(",", ""), eS = $(".savingoct").val().replaceAll(",", ""), eh = $(".savingnov").val().replaceAll(",", ""), ey = $(".savingdec").val().replaceAll(",", ""), eV = $(".savingjan2").val().replaceAll(",", ""), eA = $(".savingfeb2").val().replaceAll(",", ""), ex = $(".savingmar2").val().replaceAll(",", ""), eb = $(".savingapr2").val().replaceAll(",", ""), e$ = $(".savingmay2").val().replaceAll(",", ""), e0 = $(".savingjun2").val().replaceAll(",", ""), eG = $(".savingjul2").val().replaceAll(",", ""), eT = $(".savingaug2").val().replaceAll(",", ""), eD = $(".savingsep2").val().replaceAll(",", ""), eN = $(".savingoct2").val().replaceAll(",", ""), eR = $(".savingnov2").val().replaceAll(",", ""), ej = $(".savingdec2").val().replaceAll(",", ""); if (null != l && null != n && null != r && null != i && null != o && null != u && null != g && null != d && null != s && null != c && p > 0 && h > 0 && y > 0 && V > 0 && A > 0 && x > 0 && null != b && null != G) { var e_ = 0; $(".txTarget").each(function () { isNaN(parseFloat($(this).val())) ? e_ += 0 : e_ += parseFloat($(this).val().replaceAll(",", "")) }); var eO = parseFloat(txTargetFullYear.GetValue()), eF = parseFloat(txTarget12.GetValue()), ew = eF, eL = e_; if (eO = Math.floor(Math.abs(eO)), eF = Math.floor(Math.abs(eF)), e_ = Math.floor(Math.abs(e_)), Math.sign(ew) == Math.sign(eL)) { if (!(e_ == eF + 1 || e_ == eF || e_ + 1 == eF)) { Swal.fire("Inconsistent Target", "The amount of All Applicable Target (current SUM of input is <strong>" + eL + "</strong>) and Target 12 Months (current input as <strong> " + ew + "</strong>) need to be aligned", "error"); return } } else { Swal.fire("Inconsistent Target", "Sum of monthly target and 12 months target,both  should be positive or negative", "error"); return } var eM = 0; if (new Date(StartMonth.GetValue()).getFullYear() == projectYear) { var e_ = 0; eM = Math.abs(eM = calculateSum()) } else new Date(StartMonth.GetValue()).getFullYear() < projectYear && (eM = Math.abs(e_)); $.post(URLContent("ActiveInitiative/SaveNew"), { FormID: a, FormStatus: t, GrdSubCountry: l, GrdBrand: n, GrdLegalEntity: r, GrdCountry: i, GrdRegional: o, GrdSubRegion: u, GrdCluster: g, GrdRegionalOffice: d, GrdCostControl: s, CboConfidential: c, TxResponsibleName: v, TxDesc: m, GrdInitStatus: p, TxLaraCode: f, TxPortName: C, TxVendorSupp: I, TxAdditionalInfo: S, GrdInitType: h, GrdInitCategory: y, GrdSubCost: V, GrdActionType: A, GrdSynImpact: x, StartMonth: b, EndMonth: G, TxAgency: T, TxRPOCComment: D, TxHOComment: N, CboHoValidity: R, CboRPOCValidity: j, TxTarget12: _, TxTargetFullYear: O, TxYTDTargetFullYear: F, TxYTDSavingFullYear: w, ProjectYear: L, RelatedInitiative: M, SourceCategory: U, targetjan: E, targetfeb: Y, targetmar: k, targetapr: P, targetmay: B, targetjun: J, targetjul: H, targetaug: K, targetsep: W, targetoct: X, targetnov: z, targetdec: q, targetjan2: Q, targetfeb2: Z, targetmar2: ee, targetapr2: et, targetmay2: ea, targetjun2: el, targetjul2: en, targetaug2: er, targetsep2: ei, targetoct2: eo, targetnov2: eu, targetdec2: eg, savingjan: ed, savingfeb: es, savingmar: ec, savingapr: ev, savingmay: em, savingjun: ep, savingjul: ef, savingaug: eC, savingsep: eI, savingoct: eS, savingnov: eh, savingdec: ey, savingjan2: eV, savingfeb2: eA, savingmar2: ex, savingapr2: eb, savingmay2: e$, savingjun2: e0, savingjul2: eG, savingaug2: eT, savingsep2: eD, savingoct2: eN, savingnov2: eR, savingdec2: ej }, function (e) { "saved" == e.substring(0, 5) && ("New" == t ? $("#initsukses").html("New Initiative Number: " + e.substring(6, e.length)) : $("#initsukses").html("Initiative successfully saved!"), $("#btnEdit").click(), $("#btnClose").click(), WindowInitiative.Hide(), WindowOkSaved.Show()) }) } else Swal.fire("Mandatory field cannot blank", 'You must enter all mandatory field which marked as <font color="red">red asterisk</font>', "error") } }) } function CheckUncheckCalculate() { var e = !1; if (user_type, $("#chkAuto").is(":checked") && "" != txTargetFullYear.GetValue()) { if (new Date(StartMonth.GetValue()).getFullYear() == projectYear) { let t = ["targetjan", "targetfeb", "targetmar", "targetapr", "targetmay", "targetjun", "targetjul", "targetaug", "targetsep", "targetoct", "targetnov", "targetdec", "targetjan2", "targetfeb2", "targetmar2", "targetapr2", "targetmay2", "targetjun2", "targetjul2", "targetaug2", "targetsep2", "targetoct2", "targetnov2", "targetdec2"]; a = moment(StartMonth.GetValue()).format("M") - 1; var a, l, n, r, i = 0; l = (EndMonth.GetValue().getFullYear() - StartMonth.GetValue().getFullYear()) * 12, l -= StartMonth.GetValue().getMonth(), l += EndMonth.GetValue().getMonth(), l++; var o = []; n = Number(txTarget12.GetValue()), r = Number(txTarget12.GetValue() / l).toFixed(2); for (var u = 0; u <= l; u++)o[u] = r; if (r * l < Number(txTarget12.GetValue())) { var g = Number(txTarget12.GetValue()) - r * l; o[l - 1] = (Number(o[l - 1].replaceAll(",", "")) + Number(g)).toFixed(2) } for (var d = 0; d < t.length; d++)!0 == (e = !!(d >= a) && !!(i < l)) ? ($("." + t[d]).val(formatValue(o[i])), $("." + t[d]).prop("disabled", !1), i++) : ($("." + t[d]).val(""), $("." + t[d]).prop("disabled", !0)) } else if (new Date(StartMonth.GetValue()).getFullYear() < projectYear) { let s = ["targetjan", "targetfeb", "targetmar", "targetapr", "targetmay", "targetjun", "targetjul", "targetaug", "targetsep", "targetoct", "targetnov", "targetdec", "targetjan2", "targetfeb2", "targetmar2", "targetapr2", "targetmay2", "targetjun2", "targetjul2", "targetaug2", "targetsep2", "targetoct2", "targetnov2", "targetdec2"], c = 0; for (var d = 0; d <= 11; d++) { let v = $("." + s[d]).val().replaceAll(",", ""); "" != v && s[d].length > 0 && (c += parseFloat(v)) } c = c.toFixed(2); let m = txTarget12.GetValue() - c; for (var p = moment(EndMonth.GetValue()).format("M"), f = (m / p).toFixed(2), d = 0; d <= p - 1; d++)$("." + s[d + 12]).val(formatValue(parseFloat(f))); $("input[name='StartMonth']").prop("disabled", !0), $("input[name='StartMonth']").prop("readonly", !0), StartMonth.clientEnabled = !1 } else if (new Date(StartMonth.GetValue()).getFullYear() > projectYear) { let C = ["targetjan", "targetfeb", "targetmar", "targetapr", "targetmay", "targetjun", "targetjul", "targetaug", "targetsep", "targetoct", "targetnov", "targetdec", "targetjan2", "targetfeb2", "targetmar2", "targetapr2", "targetmay2", "targetjun2", "targetjul2", "targetaug2", "targetsep2", "targetoct2", "targetnov2", "targetdec2"]; a = moment(StartMonth.GetValue()).format("M") - 1; var l, n, r, i = 0; l = (EndMonth.GetValue().getFullYear() - StartMonth.GetValue().getFullYear()) * 12, l -= StartMonth.GetValue().getMonth(), l += EndMonth.GetValue().getMonth(), l++; var o = []; r = Number(txTarget12.GetValue() / l).toFixed(2); for (var u = 0; u <= l; u++)o[u] = r; if (r * l < Number(txTarget12.GetValue())) { var g = Number(txTarget12.GetValue()) - r * l; o[l - 1] = (Number(o[l - 1].replaceAll(",", "")) + Number(g)).toFixed(2) } for (var d = 0; d < C.length; d++)!0 == (e = !!(d >= +a + 12) && !!(i < l)) ? ($("." + C[d]).val(formatValue(o[i])), $("." + C[d]).prop("disabled", !1), i++) : ($("." + C[d]).val(""), $("." + C[d]).prop("disabled", !0)) } } else { let I = ["targetjan", "targetfeb", "targetmar", "targetapr", "targetmay", "targetjun", "targetjul", "targetaug", "targetsep", "targetoct", "targetnov", "targetdec", "targetjan2", "targetfeb2", "targetmar2", "targetapr2", "targetmay2", "targetjun2", "targetjul2", "targetaug2", "targetsep2", "targetoct2", "targetnov2", "targetdec2"]; for (var d = 0; d < I.length; d++)$("." + I[d]).prop("disabled") || $("." + I[d]).val(""); txTargetFullYear.SetValue("") } getYtdValue(), hitungtahunini() } function hitungtahunini() { var e = new Date(StartMonth.GetValue()).getFullYear(), t = new Date; let a = t.getFullYear(), l = ""; projectYear == e ? r = 12 : l = "2", l = e === a ? "" : projectYear == e ? "" : "2"; let n = ["targetjan" + l, "targetfeb" + l, "targetmar" + l, "targetapr" + l, "targetmay" + l, "targetjun" + l, "targetjul" + l, "targetaug" + l, "targetsep" + l, "targetoct" + l, "targetnov" + l, "targetdec" + l]; for (var t = new Date, r = t.getMonth(), i = 0, o = 0, u = 0; u < n.length; u++)"" != (i = $("." + n[u]).val().replaceAll(",", "")) && (i = parseFloat(i).toFixed(2), o = parseFloat(o).toFixed(2), o = parseFloat(i) + parseFloat(o)); txTargetFullYear.SetValue(o) } function getYtdValue() { let e = ["targetjan", "targetfeb", "targetmar", "targetapr", "targetmay", "targetjun", "targetjul", "targetaug", "targetsep", "targetoct", "targetnov", "targetdec"], t = ["savingjan", "savingfeb", "savingmar", "savingapr", "savingmay", "savingjun", "savingjul", "savingaug", "savingsep", "savingoct", "savingnov", "savingdec"]; var a = new Date, l = a.getMonth(); moment(StartMonth.GetValue()).format("M"); var n = new Date(StartMonth.GetValue()).getFullYear(); let r = -1, i = a.getFullYear(); var o = ""; i == n || (projectYear == n ? l = 12 : o = "2"), r = 0; for (var u = 0, g = 0, d = 0, s = 0, c = r; c < e.length; c++)c < l && ("" != (u = $("." + e[c] + o).val().replaceAll(",", "")) && (g = (u = parseFloat(u)) + (g = parseFloat(g))), "" != (d = $("." + t[c] + o).val().replaceAll(",", "")) && (s = (d = parseFloat(d)) + (s = parseFloat(s)))); txYTDTargetFullYear.SetValue(g), txYTDSavingFullYear.SetValue(s) } $(function () { $("#BtnInitiative").on("click", function () { var e = 0, t = 0, a = projectYear; e = +a - 1, t = +a, StartMonth.SetMinDate(new Date(e + "-01-01")), StartMonth.SetMaxDate(new Date(t + "-12-31")), EndMonth.SetMinDate(new Date(t + "-01-01")), EndMonth.SetMaxDate(new Date(t + 1 + "-12-31")), $.post(URLContent("ActiveInitiative/GrdSubCountryPartial"), { Id: null }, function (e) { var t; GrdSubCountryPopup.ClearItems(), GrdSubCountryPopup.AddItem("[Please Select]", null), $.each(e[0].SubCountryData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdSubCountryPopup.AddItem(t.SubCountryName, t.id) }), GrdSubCountryPopup.SelectIndex(0) }), $.post(URLContent("ActiveInitiative/GetInfoForPopUp"), { Id: null }, function (e) { var t; GrdInitType.ClearItems(), GrdActionType.ClearItems(), GrdSynImpact.ClearItems(), GrdInitStatus.ClearItems(), TxPortName.ClearItems(), GrdInitCategory.ClearItems(), CboWebinarCat.ClearItems(), $.each(e[0].SavingTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitType.AddItem(t.SavingTypeName, t.id) }), $.each(e[0].ActionTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdActionType.AddItem(t.ActionTypeName, t.id) }), $.each(e[0].SynImpactData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdSynImpact.AddItem(t.SynImpactName, t.id) }), $.each(e[0].InitStatusData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitStatus.AddItem(t.Status, t.id) }), $.each(e[0].PortNameData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && TxPortName.AddItem(t.PortName, t.id) }), $.each(e[0].MCostTypeData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdInitCategory.AddItem(t.CostTypeName, t.id) }), $.each(e[0].MSourceCategory, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && CboWebinarCat.AddItem(t.categoryname, t.id) }), GrdInitType.SelectIndex(0), GrdActionType.SelectIndex(0), GrdSynImpact.SelectIndex(0), GrdInitStatus.SelectIndex(0), TxPortName.SelectIndex(0), GrdInitCategory.SelectIndex(0), CboWebinarCat.SelectIndex(0) }), CboHoValidity.AddItem("Y"), CboHoValidity.AddItem("N"), CboWebinarCat.AddItem(""), CboRPOCValidity.AddItem("KO", "KO"), CboRPOCValidity.AddItem("Under Review", "UR"), CboRPOCValidity.AddItem("OK Level 1 - L1 if FY Target > 200 kUSD (L1= Cost controller)", "L1"), CboRPOCValidity.AddItem("OK Level 2 - L2 if FY Target > 300 kUSD (L2 =Management RO)", "L2"), CboRPOCValidity.AddItem("OK Level 3 - L3 if FY Target > 500 kUSD (L3 = Coordinateur HO)", "L3"), $("#FormStatus").val("New"), $("#btnDuplicate").prop("disabled", !0); var l = projectYear; years_right.includes(l) ? $("#btnSave").prop("disabled", !1) : $("#btnSave").prop("disabled", !0), $("#ljan").html("Jan-" + a), $("#lfeb").html("Feb-" + a), $("#lmar").html("Mar-" + a), $("#lapr").html("Apr-" + a), $("#lmay").html("May-" + a), $("#ljun").html("Jun-" + a), $("#ljul").html("Jul-" + a), $("#laug").html("Aug-" + a), $("#lsep").html("Sep-" + a), $("#loct").html("Oct-" + a), $("#lnov").html("Nov-" + a), $("#ldec").html("Dec-" + a); var n = parseInt(a) + 1; $("#lnexjan").html("Jan-" + n), $("#lnexfeb").html("Feb-" + n), $("#lnexmar").html("Mar-" + n), $("#lnexapr").html("Apr-" + n), $("#lnexmay").html("May-" + n), $("#lnexjun").html("Jun-" + n), $("#lnexjul").html("Jul-" + n), $("#lnexaug").html("Aug-" + n), $("#lnexsep").html("Sep-" + n), $("#lnexoct").html("Oct-" + n), $("#lnexnov").html("Nov-" + n), $("#lnexdec").html("Dec-" + n), WindowInitiative.Show() }), $(".txSaving, .txTarget").on("change", function () { $(this).val(formatValue($(this).val())) }), $(".targetjan, .targetfeb, .targetmar, .targetapr, .targetmay, .targetjun, .targetjul, .targetaug, .targetsep, .targetoct, .targetnov, .targetdec").on("change", function () { hitungtahunini() }), $(".targetjan2, .targetfeb2, .targetmar2, .targetapr2, .targetmay2, .targetjun2, .targetjul2, .targetaug2, .targetsep2, .targetoct2, .targetnov2, .targetdec2").on("change", function () { hitungtahunini() }), $("#btnSave").on("click", function () { SaveInitiative() }), $("#btnEditx").on("click", function () { var e = $(this).text(); "Cancel" === e ? ($(this).text("Edit"), $("#chkAuto").prop("disabled", !0), CheckUncheck()) : "Edit" === e && ($(this).text("Cancel"), $("#chkAuto").prop("disabled", !1), CheckUncheck()) }), $("#btnClose").on("click", function () { $(".txTarget").prop("disabled", !1), $(".txTarget").prop("readonly", !1), WindowInitiative.Hide() }), $("#btnDuplicate").on("click", function () { var e = GrdSubCountryPopup.GetText(), t = GrdSubCountryPopup.GetValue(), a = GrdBrandPopup.GetText(), l = GrdLegalEntityPopup.GetText(); $("#FormStatus").val("New"), $("#LblInitiative").text("DUP-0001"), $("#btnDuplicate").prop("disabled", !0), $.post(URLContent("ActiveInitiative/GrdSubCountryPartial"), { Id: null }, function (n) { GrdSubCountryPopup.ClearItems(), $.each(n[0].SubCountryData, function (e, t) { r = JSON.parse(t = JSON.stringify(t)), GrdSubCountryPopup.AddItem(r.SubCountryName, r.id) }), GrdSubCountryPopup.SetText(e), $.post(URLContent("ActiveInitiative/GetCountryBySub"), { id: t }, function (e) { GrdBrandPopup.ClearItems(), GrdLegalEntityPopup.ClearItems(), $.each(e[0].BrandData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdBrandPopup.AddItem(t.BrandName, t.id) }), GrdBrandPopup.SetText(a); var t, n = GrdBrandPopup.GetValue(), r = $("#GrdCountryVal").val(), i = GrdSubCountryPopup.GetValue(), o = $("#GrdCostControlVal").val(); $.post(URLContent("ActiveInitiative/GetLegalFromBrand"), { brandid: n, countryid: r, subcountryid: i, costcontrolsiteid: o }, function (e) { var t; $.each(e[0].LegalEntityData, function (e, a) { null != (t = JSON.parse(a = JSON.stringify(a))) && GrdLegalEntityPopup.AddItem(t.LegalEntityName, t.id) }), GrdLegalEntityPopup.SetText(l) }) }); var r, i = projectYear; years_right.includes(i) ? $("#btnSave").prop("disabled", !1) : $("#btnSave").prop("disabled", !0), StartMonth.SetValue(), EndMonth.SetValue(); var o = 0, u = 0, g = projectYear; o = +g - 1, u = +g, StartMonth.SetMinDate(new Date(o + "-01-01")), StartMonth.SetMaxDate(new Date(u + "-12-31")), EndMonth.SetMinDate(new Date(u + "-01-01")), EndMonth.SetMaxDate(new Date(u + 1 + "-12-31")), $(".txTarget").prop("disabled", !1), $(".txSaving").prop("disabled", !1), $(".txTarget").val(""), $(".txSaving").val(""), txTarget12.SetValue(""), txTargetFullYear.SetValue(""), txYTDTargetFullYear.SetValue(""), txYTDSavingFullYear.SetValue(""), StartMonth.clientEnabled = !0, EndMonth.clientEnabled = !0, $("#chkAuto").prop("disabled", !1) }), Swal.fire("Duplicated Successfully", "Initiative has been duplicated successfully. You can save it now.", "success") }), setTimeout(function () { UpdateFigureWidget(GrdMainInitiative) }, 300) });