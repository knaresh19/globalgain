@model IQueryable<t_initiative>

@{
    short year = (short)DateTime.Now.Year;
    if (ViewData["ProjectionYear"] != null)
    {
        year = (short)ViewData["ProjectionYear"];
    }
}
@{
    var grid = Html.DevExpress().GridView(settings =>
    {
        settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
        settings.Height = System.Web.UI.WebControls.Unit.Percentage(100);
        settings.Name = "GrdInitDeleted";
        settings.CallbackRouteValues = new { Controller = "ToBeDeletedList", Action = "GrdInitDeletedPartial" };

        settings.SettingsResizing.ColumnResizeMode = ColumnResizeMode.Control;
        settings.SettingsResizing.Visualization = ResizingMode.Live;

        settings.KeyFieldName = "id";
        settings.Styles.Row.Cursor = "pointer";

        settings.SettingsEditing.AddNewRowRouteValues = new { Controller = "ToBeDeletedList", Action = "GrdInitDeletedPartialAddNew" };
        settings.SettingsEditing.UpdateRowRouteValues = new { Controller = "ToBeDeletedList", Action = "GrdInitDeletedPartialUpdate" };
        settings.SettingsEditing.DeleteRowRouteValues = new { Controller = "ToBeDeletedList", Action = "GrdInitDeletedPartialDelete" };
        settings.CustomActionRouteValues = new { Controller = "ToBeDeletedList", Action = "CustomCallback" };
        settings.SettingsEditing.Mode = GridViewEditingMode.Inline; // GridViewEditingMode.EditFormAndDisplayRow;
        settings.SettingsBehavior.ConfirmDelete = true;

        settings.CommandColumn.Visible = true;
        settings.CommandColumn.ShowSelectCheckbox = true;
        settings.CommandColumn.ShowClearFilterButton = true;

        settings.CommandColumn.FixedStyle = GridViewColumnFixedStyle.Left;
        settings.CommandColumn.Width = System.Web.UI.WebControls.Unit.Pixel(35);
        //settings.CommandColumn.ShowNewButton = true;
        settings.CommandColumn.ShowDeleteButton = false;
        settings.CommandColumn.ShowEditButton = false;
        settings.CommandColumn.Caption = " ";
        settings.CommandColumn.SelectAllCheckboxMode = GridViewSelectAllCheckBoxMode.Page;

        //settings.CommandColumn.SetHeaderTemplateContent(conainer =>
        //{
        //    ViewContext.Writer.Write("<center>");
        //    Html.DevExpress().CheckBox(settingsCheckBox =>
        //    {
        //        settingsCheckBox.Name = "cbSelectAll";
        //        settingsCheckBox.Properties.AllowGrayed = true;
        //        settingsCheckBox.Properties.ClientSideEvents.ValueChanged = "onCheckedChanged";
        //        if (Session["allChecked"] != null)
        //            settingsCheckBox.Checked = (bool)Session["allChecked"];
        //    }).Render();
        //    ViewContext.Writer.Write("</center>");
        //});


        settings.SettingsExport.EnableClientSideExportAPI = true;

        settings.SettingsPager.Visible = true;
        settings.Settings.ShowGroupPanel = true;
        settings.Settings.ShowFilterRow = true;
        settings.SettingsBehavior.AllowSelectByRowClick = true;

        settings.SettingsPager.PageSize = 10;
        settings.SettingsPager.PageSizeItemSettings.Visible = true;

        settings.EnableRowsCache = false;
        settings.SettingsCookies.Enabled = false;
        settings.SettingsCookies.StoreFiltering = true;
        settings.Settings.ShowFilterRow = true;
        settings.Settings.ShowFilterRowMenu = false;
        settings.Settings.ShowHeaderFilterButton = true;
        settings.Settings.ShowFilterBar = DevExpress.Web.GridViewStatusBarMode.Hidden;

        settings.SettingsAdaptivity.AdaptivityMode = GridViewAdaptivityMode.HideDataCellsWindowLimit;
        settings.SettingsAdaptivity.AdaptiveColumnPosition = GridViewAdaptiveColumnPosition.Right;
        settings.SettingsAdaptivity.AdaptiveDetailColumnCount = 1;

        settings.SettingsExport.Landscape = true;
        settings.SettingsExport.PaperKind = System.Drawing.Printing.PaperKind.A3;
        settings.SettingsExport.TopMargin = 0;
        settings.SettingsExport.LeftMargin = 0;
        settings.SettingsExport.RightMargin = 0;
        settings.SettingsExport.Styles.Cell.Font.Size = 8;

        #region column
        settings.Columns.Add(c =>
        {
            c.FieldName = "InitNumber";
            c.Width = 100;
            c.FixedStyle = GridViewColumnFixedStyle.Left;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "RelatedInitiative";
            c.Width = 100;
            c.FixedStyle = GridViewColumnFixedStyle.Left;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "SubCountryID";
            c.Name = "SubCountryID";
            c.Caption = "Sub Country";
            c.Width = 150;
            c.FixedStyle = GridViewColumnFixedStyle.Left;
            c.CellStyle.BackColor = System.Drawing.Color.Ivory;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "SubCountryName";
                p.ValueField = "id";
                p.ValueType = typeof(string);
                p.ClientInstanceName = "SubCountryID";
                //p.ClientSideEvents.SelectedIndexChanged = "OnSubCountryChanged";
                p.BindList(ViewData["SubCountryName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "BrandID";
            c.Name = "BrandID";
            c.Caption = "Brand";
            c.Width = 100;
            c.CellStyle.BackColor = System.Drawing.Color.Ivory;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "brandname";
                p.ValueField = "id";
                p.ClientInstanceName = "BrandID";
                p.ValueType = typeof(string);
                //p.ClientSideEvents.SelectedIndexChanged = "OnBrandChanged";
                p.BindList(ViewData["brandname"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "CountryID";
            c.Name = "CountryID";
            c.Caption = "Country";
            c.Width = 150;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "CountryName";
                p.ValueField = "id";
                p.ClientInstanceName = "CountryID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["CountryName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "RegionID";
            c.Name = "RegionID";
            c.Caption = "Region";
            c.Width = 100;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "RegionName";
                p.ValueField = "id";
                p.ClientInstanceName = "RegionID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["mregions"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "SubRegionID";
            c.Caption = "Sub Region";
            c.Width = 100;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "SubRegionName";
                p.ValueField = "id";
                p.ClientInstanceName = "SubRegionID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["msubregion"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "ClusterID";
            c.Caption = "Cluster";
            c.Width = 200;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "ClusterName";
                p.ValueField = "id";
                p.ClientInstanceName = "ClusterID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["mcluster"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "RegionalOfficeID";
            c.Name = "RegionalOfficeID";
            c.Caption = "Regional Office";
            c.Width = 200;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "RegionalOffice_Name";
                p.ValueField = "id";
                p.ClientInstanceName = "RegionalOfficeID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["mregional_office"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "CostControlID";
            c.Name = "CostControlID";
            c.Caption = "Cost Control Site";
            c.Width = 100;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "CostControlSiteName";
                p.ValueField = "id";
                p.ClientInstanceName = "CostControlID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["CostControlSiteName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "LegalEntityID";
            c.Name = "LegalEntityID";
            c.Caption = "Legal Entity Name";
            c.Width = 250;
            c.CellStyle.BackColor = System.Drawing.Color.Ivory;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "LegalEntityName";
                p.ValueField = "id";
                p.ClientInstanceName = "LegalEntityID";
                p.ValueType = typeof(string);
                p.BindList(ViewData["LegalEntityName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "Confidential";
            c.Caption = "Confidential";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.ValueType = typeof(string);
                p.Items.Add("Y");
                p.Items.Add("N");
            });
        });
        settings.Columns.Add("Description").Width = 1000;
        settings.Columns.Add("ResponsibleFullName").Width = 150;
        settings.Columns.Add(c =>
        {
            c.FieldName = "InitiativeType";
            c.Name = "InitiativeType";
            c.Caption = "TypeOf Initiative";
            c.Width = 200;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "SavingTypeName";
                p.ValueField = "id";
                p.ClientInstanceName = "InitiativeType";
                //p.ClientSideEvents.SelectedIndexChanged = "OnInitiativeTypeChanged";
                p.ValueType = typeof(string);
                p.BindList(ViewData["SavingTypeName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "CostCategoryID";
            c.Name = "CostCategoryID";
            c.Caption = "Item Category";
            c.Width = 250;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "CostTypeName";
                p.ValueField = "id";
                p.ClientInstanceName = "CostCategoryID";
                //p.ClientSideEvents.SelectedIndexChanged = "OnCostCategoryChanged";
                p.ValueType = typeof(string);
                p.BindList(ViewData["CostTypeName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "SubCostCategoryID";
            c.Name = "SubCostCategoryID";
            c.Caption = "Sub Cost Item Impacted";
            c.Width = 200;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "SubCostName";
                p.ValueField = "id";
                p.ValueType = typeof(string);
                p.ClientInstanceName = "SubCostCategoryID";
                p.BindList(ViewData["SubCostName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "ActionTypeID";
            c.Name = "ActionTypeID";
            c.Caption = "Action Type";
            c.Width = 250;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "ActionTypeName";
                p.ValueField = "id";
                p.ValueType = typeof(string);
                p.ClientInstanceName = "ActionTypeID";
                p.BindList(ViewData["ActionTypeName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "SynergyImpactID";
            c.Caption = "Synergy Impact";
            c.Width = 200;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "SynImpactName";
                p.ValueField = "id";
                p.ValueType = typeof(string);
                p.BindList(ViewData["SynImpactName"]);
            });
        });
        //settings.Columns.Add("StartMonth").Width = 200;
        settings.Columns.Add(c =>
        {
            c.FieldName = "StartMonth";
            c.ColumnType = MVCxGridViewColumnType.DateEdit;
            c.PropertiesEdit.DisplayFormatString = "MMMM, yyyy";
            c.Width = 200;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        //settings.Columns.Add("EndMonth").Width = 200;
        settings.Columns.Add(c =>
        {
            c.FieldName = "EndMonth";
            c.ColumnType = MVCxGridViewColumnType.DateEdit;
            c.PropertiesEdit.DisplayFormatString = "MMMM, yyyy";
            c.Width = 200;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "LaraCode";
            c.Caption = "Lara Charge Code";
            c.PropertiesEdit.DisplayFormatString = "";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "TargetTY";
            c.Caption = "Target 12 Months (USD)";
            c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
            c.Width = 120;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "TargetNY";
            c.Caption = "Target FY Months (USD)";
            c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
            c.Width = 120;
            c.CellStyle.BackColor = System.Drawing.Color.AliceBlue;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "HOValidity";
            c.Caption = "HO Validity";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.ValueType = typeof(string);
                p.Items.Add("Y");
                p.Items.Add("N");
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "RPOCControl";
            c.Caption = "RPOC Control";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.ValueType = typeof(string);
               // p.Items.Add("Y");
                //p.Items.Add("N");
                p.Items.Add("KO", "KO");
                p.Items.Add("Under Review", "UR");
                p.Items.Add("OK Level 1 (Cost controller)", "L1");
                p.Items.Add("OK Level 2 (Management RO)", "L2");
                p.Items.Add("OK Level 3 (Coordinateur HO)", "L3");
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "InitStatus";
            c.Caption = "Initiative Status";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "Status";
                p.ValueField = "id";
                p.ValueType = typeof(string);
                p.BindList(ViewData["Status"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "YTDTarget";
            c.Caption = "YTD Target";
            c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "YTDAchieved";
            c.Caption = "YTD Achieved";
            c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });

        settings.Columns.AddBand(JanuaryBand =>
        {
            JanuaryBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JanuaryBand.Caption = "January " + year;
            JanuaryBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JanuaryBand.Columns.Add(c =>
            {
                c.FieldName = "TargetJan";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            JanuaryBand.Columns.Add(c =>
            {
                c.FieldName = "AchJan";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(FebruaryBand =>
        {
            FebruaryBand.Caption = "February " + year;
            FebruaryBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            FebruaryBand.Columns.Add(c =>
            {
                c.FieldName = "TargetFeb";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            FebruaryBand.Columns.Add(c =>
            {
                c.FieldName = "AchFeb";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(MarchBand =>
        {
            MarchBand.Caption = "March " + year;
            MarchBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            MarchBand.Columns.Add(c =>
            {
                c.FieldName = "TargetMar";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            MarchBand.Columns.Add(c =>
            {
                c.FieldName = "AchMar";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(AprilBand =>
        {
            AprilBand.Caption = "April " + year;
            AprilBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            AprilBand.Columns.Add(c =>
            {
                c.FieldName = "TargetApr";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            AprilBand.Columns.Add(c =>
            {
                c.FieldName = "AchApr";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(MayBand =>
        {
            MayBand.Caption = "May " + year;
            MayBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            MayBand.Columns.Add(c =>
            {
                c.FieldName = "TargetMay";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            MayBand.Columns.Add(c =>
            {
                c.FieldName = "AchMay";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(JunBand =>
        {
            JunBand.Caption = "June " + year;
            JunBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JunBand.Columns.Add(c =>
            {
                c.FieldName = "TargetJun";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            JunBand.Columns.Add(c =>
            {
                c.FieldName = "AchJun";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Caption = "Achieved";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(JulBand =>
        {
            JulBand.Caption = "July " + year;
            JulBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JulBand.Columns.Add(c =>
            {
                c.FieldName = "TargetJul";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            JulBand.Columns.Add(c =>
            {
                c.FieldName = "AchJul";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(AugBand =>
        {
            AugBand.Caption = "August " + year;
            AugBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            AugBand.Columns.Add(c =>
            {
                c.FieldName = "TargetAug";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            AugBand.Columns.Add(c =>
            {
                c.FieldName = "AchAug";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(SepBand =>
        {
            SepBand.Caption = "September " + year;
            SepBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            SepBand.Columns.Add(c =>
            {
                c.FieldName = "TargetSep";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            SepBand.Columns.Add(c =>
            {
                c.FieldName = "AchSep";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(OctBand =>
        {
            OctBand.Caption = "October " + year;
            OctBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            OctBand.Columns.Add(c =>
            {
                c.FieldName = "TargetOct";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            OctBand.Columns.Add(c =>
            {
                c.FieldName = "AchOct";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(NovBand =>
        {
            NovBand.Caption = "November " + year + "";
            NovBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            NovBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNov";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            NovBand.Columns.Add(c =>
            {
                c.FieldName = "AchNov";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(DecBand =>
        {
            DecBand.Caption = "December " + year;
            DecBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            DecBand.Columns.Add(c =>
            {
                c.FieldName = "TargetDec";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            DecBand.Columns.Add(c =>
            {
                c.FieldName = "AchDec";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });

        settings.Columns.AddBand(JanuaryNexBand =>
        {
            JanuaryNexBand.Caption = "January " + (year + 1) + "";
            JanuaryNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JanuaryNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexJan";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            JanuaryNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexJan";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(FebruaryNexBand =>
        {
            FebruaryNexBand.Caption = "February " + (year + 1);
            FebruaryNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            FebruaryNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexFeb";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            FebruaryNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexFeb";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(MarchNexBand =>
        {
            MarchNexBand.Caption = "March " + (year + 1);
            MarchNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            MarchNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexMar";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            MarchNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexMar";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(AprilNexBand =>
        {
            AprilNexBand.Caption = "April " + (year + 1);
            AprilNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            AprilNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexApr";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            AprilNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexApr";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(MayNexBand =>
        {
            MayNexBand.Caption = "May " + (year + 1);
            MayNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            MayNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexMay";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            MayNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexMay";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(JunNexBand =>
        {
            JunNexBand.Caption = "June " + (year + 1);
            JunNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JunNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexJun";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            JunNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexJun";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(JulNexBand =>
        {
            JulNexBand.Caption = "July " + (year + 1);
            JulNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            JulNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexJul";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            JulNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexJul";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(AugNexBand =>
        {
            AugNexBand.Caption = "August " + (year + 1);
            AugNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            AugNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexAug";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            AugNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexAug";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(SepNexBand =>
        {
            SepNexBand.Caption = "September " + (year + 1);
            SepNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            SepNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexSep";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            SepNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexSep";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(OctNexBand =>
        {
            OctNexBand.Caption = "October " + (year + 1);
            OctNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            OctNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexOct";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            OctNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexOct";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(NovNexBand =>
        {
            NovNexBand.Caption = "November " + (year + 1);
            NovNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            NovNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexNov";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            NovNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexNov";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });
        settings.Columns.AddBand(DecNexBand =>
        {
            DecNexBand.Caption = "December " + (year + 1);
            DecNexBand.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            DecNexBand.Columns.Add(c =>
            {
                c.FieldName = "TargetNexDec";
                c.Caption = "Target";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
            DecNexBand.Columns.Add(c =>
            {
                c.FieldName = "AchNexDec";
                c.Caption = "Achieved";
                c.PropertiesEdit.DisplayFormatString = "{0:#,###.00}";
                c.Width = 100;
                c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            });
        });

        settings.Columns.Add(c =>
        {
            c.FieldName = "AgencyComment";
            c.Caption = "Agency Comment";
            c.Width = 250;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "RPOCComment";
            c.Caption = "RPOC Comment";
            c.Width = 250;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "HOComment";
            c.Caption = "HO Comment";
            c.Width = 250;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "AdditionalInfo";
            c.Caption = "Additional Information";
            c.Width = 250;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "PortID";
            c.Caption = "Port Name";
            c.Width = 200;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.EditorProperties().ComboBox(p =>
            {
                p.TextField = "portName";
                p.ValueField = "id";
                p.ValueType = typeof(string);
                p.BindList(ViewData["portName"]);
            });
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "VendorName";
            c.Caption = "Vendor Supplier";
            c.Width = 100;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
            c.HeaderStyle.Wrap = DefaultBoolean.True;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "UploadedFile";
            c.Caption = "Uploaded File(s)";
            c.Width = 390;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        settings.Columns.Add(c =>
        {
            c.FieldName = "CreatedDate";
            c.Caption = "Created Date";
            c.PropertiesEdit.DisplayFormatString = "MMMM dd, yyyy";
            c.Width = 390;
            c.HeaderStyle.HorizontalAlign = System.Web.UI.WebControls.HorizontalAlign.Center;
        });
        #endregion

        //Context Menu here
        settings.SettingsContextMenu.Enabled = true;
        settings.SettingsContextMenu.EnableRowMenu = DefaultBoolean.True;


        settings.CellEditorInitialize = (s, e) =>
        {
            if (e.Editor is ASPxComboBox)
            {
                ASPxComboBox combo = ((ASPxComboBox)e.Editor);
                var gridNew = e.Column.Grid; Int64 SCID = 0;
                GAIN.Models.GainEntities db = new GAIN.Models.GainEntities(GAIN.Controllers.clsSecretManager.GetConnectionstring(System.Configuration.ConfigurationManager.AppSettings["rdssecret"]));
                GAIN.Models.msubcountry modelsubcountries = new GAIN.Models.msubcountry();
                List<GAIN.Models.mbrand> modelbrands = new List<GAIN.Models.mbrand>();
                GAIN.Models.mcountry modelcountry = new GAIN.Models.mcountry();
                GAIN.Models.mregion modelregion = new GAIN.Models.mregion();
                GAIN.Models.msubregion modelsubregion = new GAIN.Models.msubregion();
                GAIN.Models.mcluster modelcluster = new GAIN.Models.mcluster();
                GAIN.Models.mregional_office modelregionaloffice = new GAIN.Models.mregional_office();

                switch (e.Column.FieldName)
                {
                    case "SubCountryID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "SubCountryID");

                        modelsubcountries = db.msubcountries.Where(sc => sc.id == SCID).FirstOrDefault();

                        combo.Items.Clear();
                        combo.Items.Add(modelsubcountries.SubCountryName, modelsubcountries.id);
                        combo.TextField = "SubCountryName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "SubCountryID";
                        //combo.ClientSideEvents.SelectedIndexChanged = "OnSubCountryChanged";
                        break;
                    case "BrandID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "CountryID");

                        modelbrands = db.mbrands.SqlQuery("SELECT b.id,b.brandname FROM mbrandcountry a LEFT JOIN mbrand b ON a.brandid = b.id WHERE countryid = " + SCID + "And b.isDeleted='N'").ToList();

                        combo.Items.Clear();
                        foreach (var v in modelbrands)
                        {
                            combo.Items.Add(v.brandname, v.id);
                        }
                        combo.TextField = "brandname";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "BrandID";
                        //combo.ClientSideEvents.SelectedIndexChanged = "OnBrandChanged";
                        break;
                    case "CountryID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "CountryID");

                        modelcountry = db.mcountries.Where(ct => ct.id == SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modelcountry.CountryName, modelcountry.id);
                        combo.TextField = "CountryName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "CountryID";
                        break;
                    case "RegionID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "CountryID");

                        modelregion = db.mregions.SqlQuery("SELECT b.id,b.regionname,b.isActive FROM mcountry a LEFT JOIN mregion b ON a.RegionID = b.id WHERE a.id = " + SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modelregion.RegionName, modelregion.id);
                        combo.TextField = "RegionName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "RegionID";
                        break;
                    case "SubRegionID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "RegionID");

                        modelsubregion = db.msubregions.Where(sbr => sbr.RegionID == SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modelsubregion.SubRegionName, modelsubregion.id);
                        combo.TextField = "SubRegionName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "SubRegionID";
                        break;
                    case "ClusterID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "ClusterID");

                        modelcluster = db.mclusters.Where(sbr => sbr.id == SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modelcluster.ClusterName, modelcluster.id);
                        combo.TextField = "ClusterName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "ClusterID";
                        break;
                    case "RegionalOfficeID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "RegionalOfficeID");

                        modelregionaloffice = db.mregional_office.Where(sbr => sbr.id == SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modelregionaloffice.RegionalOffice_Name, modelregionaloffice.id);
                        combo.TextField = "RegionalOffice_Name";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "RegionalOfficeID";
                        break;
                    case "CostControlID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "CostControlID");

                        GAIN.Models.mcostcontrolsite modelcostcontrol = new GAIN.Models.mcostcontrolsite();
                        modelcostcontrol = db.mcostcontrolsites.Where(sbr => sbr.id == SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modelcostcontrol.CostControlSiteName, modelcostcontrol.id);
                        combo.TextField = "CostControlSiteName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "CostControlID";
                        break;
                    case "LegalEntityID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "LegalEntityID");

                        GAIN.Models.mlegalentity modellegalentity = new GAIN.Models.mlegalentity();
                        modellegalentity = db.mlegalentities.Where(sbr => sbr.id == SCID).FirstOrDefault();
                        combo.Items.Clear();
                        combo.Items.Add(modellegalentity.LegalEntityName, modellegalentity.id);
                        combo.TextField = "LegalEntityName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "LegalEntityID";
                        break;
                    case "CostCategoryID":
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "InitiativeType");

                        List<GAIN.Models.mcosttype> modelitemcategory = new List<GAIN.Models.mcosttype>();
                        modelitemcategory = db.mcosttypes.SqlQuery("SELECT b.id, b.CostTypeName FROM t_subcostinitiative a LEFT JOIN mcosttype b ON a.costitemid = b.id WHERE a.savingtypeid = " + SCID + " GROUP BY b.id, b.CostTypeName").ToList();
                        combo.Items.Clear();
                        foreach (var v in modelitemcategory)
                        {
                            combo.Items.Add(v.CostTypeName, v.id);
                        }
                        combo.TextField = "CostTypeName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "CostCategoryID";
                        break;
                    case "SubCostCategoryID":
                        Int64 SCID2 = 0; Int64 SCID3 = 0;
                        gridNew = e.Column.Grid;
                        SCID = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "InitiativeType");
                        SCID2 = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "CostCategoryID");
                        SCID3 = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "BrandID");

                        List<GAIN.Models.msubcost> modelsubcategory = new List<GAIN.Models.msubcost>();
                        modelsubcategory = db.msubcosts.SqlQuery("SELECT b.id,b.SubCostName FROM t_subcostbrand a LEFT JOIN msubcost b ON a.subcostid = b.id WHERE a.savingtypeid = " + SCID + " AND a.costtypeid = " + SCID2 + " AND a.brandid = " + SCID3 + " GROUP BY b.SubCostName").ToList();
                        combo.Items.Clear();
                        foreach (var v in modelsubcategory)
                        {
                            combo.Items.Add(v.SubCostName, v.id);
                        }
                        combo.TextField = "SubCostName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "SubCostCategoryID";
                        break;
                    case "ActionTypeID":
                        gridNew = e.Column.Grid;
                        SCID2 = (long)gridNew.GetRowValuesByKeyValue(e.KeyValue, "CostCategoryID");

                        List<GAIN.Models.mactiontype> moodelactiontype = new List<GAIN.Models.mactiontype>();
                        moodelactiontype = db.mactiontypes.SqlQuery("SELECT a.actiontypeid AS id,c.ActionTypeName FROM t_cost_actiontype a LEFT JOIN mcosttype b ON a.costitemid = b.id LEFT JOIN mactiontype c ON a.actiontypeid = c.id WHERE a.costitemid = " + SCID2 + "; ").ToList();
                        combo.Items.Clear();
                        foreach (var v in moodelactiontype)
                        {
                            combo.Items.Add(v.ActionTypeName, v.id);
                        }
                        combo.TextField = "ActionTypeName";
                        combo.ValueField = "id";
                        combo.ClientInstanceName = "ActionTypeID";
                        break;
                }
            }
        };

        //settings.ClientSideEvents.ContextMenuItemClick = "onContextMenuItemFormGridViewClick";
        //settings.ClientSideEvents.Init = "OnInit";
        settings.ClientSideEvents.BeginCallback = "OnBeginCallback";


        //settings.ClientSideEvents.EndCallback = "OnEndCallback";
        //settings.ClientSideEvents.RowDblClick = "onRowDoubleClick";

        settings.Settings.HorizontalScrollBarMode = ScrollBarMode.Visible;
        //settings.Settings.VerticalScrollBarMode = ScrollBarMode.Auto;

        settings.FillContextMenuItems = (sender, e) =>
        {
            e.Items.Clear();

            GridViewContextMenuItem item1 = e.CreateItem("Detail Info", "Info");
            item1.Image.IconID = DevExpress.Web.ASPxThemes.IconID.SupportInfo16x16;

            GridViewContextMenuItem item2 = e.CreateItem("Edit Detail", "EditDetail");
            item2.Image.IconID = DevExpress.Web.ASPxThemes.IconID.ActionsEdit16x16devav;

            e.Items.Add(item1);
            e.Items.Add(item2);
        };
    });
    if (ViewData["EditError"] != null)
    {
        grid.SetEditErrorText((string)ViewData["EditError"]);
    }
}
@*@grid.Bind(Model).GetHtml()*@
@grid.BindToEF(string.Empty, string.Empty, (s, e) =>
{
    e.KeyExpression = "id";
    e.QueryableSource = Model;
}).GetHtml()
